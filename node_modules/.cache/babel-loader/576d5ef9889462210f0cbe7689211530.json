{"ast":null,"code":"var _jsxFileName = \"F:\\\\coding\\\\python\\\\Django_Project\\\\chat_service\\\\chatfrontend\\\\src\\\\Pages\\\\usersList.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useState, useEffect, useContext } from \"react\";\nimport searchImg from \"../assets/search.png\";\nimport Loader from \"../components/loader\";\nimport { axiosHandler, getToken, LastUserChat } from \"../helper\";\nimport { activeChatUserAction, triggerRefreshUserListAction } from \"../stateManagement/actions\";\nimport { store } from \"../stateManagement/store\";\nimport { PROFILE_URL } from \"../urls\";\nimport { UserMain } from \"./homeComponents\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet goneNext = false;\n\nfunction UsersList() {\n  _s();\n\n  const [users, setUsers] = useState([]);\n  const [fetching, setFetching] = useState(true);\n  const [nextPage, setNextPage] = useState(1);\n  const [canGoNext, setCanGoNext] = useState(false);\n  const [search, setSearch] = useState(\"\");\n  const {\n    state: {\n      triggerRefreshUserList\n    },\n    dispatch\n  } = useContext(store);\n  useEffect(() => {\n    getUserList();\n  }, [search]);\n  useEffect(() => {\n    if (triggerRefreshUserList) {\n      getUserList();\n      dispatch({\n        type: triggerRefreshUserListAction,\n        payload: false\n      });\n    }\n  }, [triggerRefreshUserList]);\n\n  const getUserList = async function () {\n    let append = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    let extra = \"\";\n\n    if (search !== \"\") {\n      extra += `&keyword=${search}`;\n    }\n\n    setCanGoNext(false);\n\n    const _token = await getToken();\n\n    const _users = await axiosHandler({\n      method: \"get\",\n      url: PROFILE_URL + `?page=${nextPage}${extra}`,\n      token: _token\n    }).catch(e => null);\n\n    if (_users) {\n      if (_users.data.next) {\n        setNextPage(nextPage + 1);\n        setCanGoNext(true);\n      }\n\n      if (append) {\n        setUsers([...users, ..._users.data.results]);\n        goneNext = false;\n      } else {\n        setUsers(_users.data.results);\n      }\n\n      setFetching(false);\n    }\n\n    checkLastChat(_users.data.results);\n  };\n\n  const checkLastChat = users => {\n    let lastUserChat = localStorage.getItem(LastUserChat);\n\n    if (lastUserChat) {\n      lastUserChat = JSON.parse(lastUserChat);\n\n      if (users.filter(item => item.id === lastUserChat.id).length) {\n        setActiveUser(lastUserChat);\n      }\n    }\n  };\n\n  const setActiveUser = user_data => {\n    localStorage.setItem(LastUserChat, JSON.stringify(user_data));\n    dispatch({\n      type: activeChatUserAction,\n      payload: user_data\n    });\n  };\n\n  const handleScroll = e => {\n    if (e.target.scrollTop >= e.target.scrollHeight - (e.target.offsetHeight + 200)) {\n      if (canGoNext && !goneNext) {\n        getUserList(true);\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(SearchDebouce, {\n      setSearch: setSearch\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"userList\",\n      onScroll: handleScroll,\n      children: fetching ? /*#__PURE__*/_jsxDEV(\"center\", {\n        children: /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }, this) : users.length < 1 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"noUser\",\n        children: \"You don't have any user to chat with.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 11\n      }, this) : users.map((item, i) => /*#__PURE__*/_jsxDEV(UserMain, {\n        name: `${item.first_name || \"\"} ${item.last_name || \"\"}`,\n        profilePicture: item.profile_picture ? item.profile_picture.file_upload : \"\",\n        caption: item.caption,\n        count: item.message_count,\n        clickable: true,\n        onClick: () => setActiveUser(item)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n}\n\n_s(UsersList, \"eyHUvp4SwTy0rNIfqwzsc34eiMQ=\");\n\n_c = UsersList;\nlet debouceTimeout;\n\nconst SearchDebouce = props => {\n  _s2();\n\n  const [search, setSearch] = useState(\"\");\n  useEffect(() => {\n    clearTimeout(debouceTimeout);\n    debouceTimeout = setTimeout(() => {\n      props.setSearch(search);\n    }, 1000);\n  }, [search]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"searchCon\",\n    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n      src: searchImg\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      placeholder: \"Search users\",\n      value: search,\n      onChange: e => setSearch(e.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 128,\n    columnNumber: 5\n  }, this);\n};\n\n_s2(SearchDebouce, \"/GLerps70H6LPpMRxJUwTVVbb9A=\");\n\n_c2 = SearchDebouce;\nexport default UsersList;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"UsersList\");\n$RefreshReg$(_c2, \"SearchDebouce\");","map":{"version":3,"names":["React","useState","useEffect","useContext","searchImg","Loader","axiosHandler","getToken","LastUserChat","activeChatUserAction","triggerRefreshUserListAction","store","PROFILE_URL","UserMain","goneNext","UsersList","users","setUsers","fetching","setFetching","nextPage","setNextPage","canGoNext","setCanGoNext","search","setSearch","state","triggerRefreshUserList","dispatch","getUserList","type","payload","append","extra","_token","_users","method","url","token","catch","e","data","next","results","checkLastChat","lastUserChat","localStorage","getItem","JSON","parse","filter","item","id","length","setActiveUser","user_data","setItem","stringify","handleScroll","target","scrollTop","scrollHeight","offsetHeight","map","i","first_name","last_name","profile_picture","file_upload","caption","message_count","debouceTimeout","SearchDebouce","props","clearTimeout","setTimeout","value"],"sources":["F:/coding/python/Django_Project/chat_service/chatfrontend/src/Pages/usersList.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport searchImg from \"../assets/search.png\";\nimport Loader from \"../components/loader\";\nimport { axiosHandler, getToken, LastUserChat } from \"../helper\";\nimport {activeChatUserAction, triggerRefreshUserListAction} from \"../stateManagement/actions\";\nimport { store } from \"../stateManagement/store\";\nimport { PROFILE_URL } from \"../urls\";\nimport { UserMain } from \"./homeComponents\";\n\nlet goneNext = false;\n\nfunction UsersList() {\n  const [users, setUsers] = useState([]);\n  const [fetching, setFetching] = useState(true);\n  const [nextPage, setNextPage] = useState(1);\n  const [canGoNext, setCanGoNext] = useState(false);\n  const [search, setSearch] = useState(\"\")\n\n  const { state:{triggerRefreshUserList}, dispatch } = useContext(store);\n\n  useEffect(() => {\n    getUserList();\n  }, [search]);\n\n  useEffect(() => {\n    if(triggerRefreshUserList){\n      getUserList()\n      dispatch({type: triggerRefreshUserListAction, payload: false})\n    }\n\n  }, [triggerRefreshUserList])\n\n  const getUserList = async (append=false) => {\n    let extra=\"\";\n    if(search !== \"\"){\n      extra += `&keyword=${search}`\n    }\n    setCanGoNext(false);\n    const _token = await getToken();\n    const _users = await axiosHandler({\n      method: \"get\",\n      url: PROFILE_URL + `?page=${nextPage}${extra}`,\n      token: _token,\n    }).catch((e) => null);\n    if (_users) {\n      if (_users.data.next) {\n        setNextPage(nextPage + 1);\n        setCanGoNext(true);\n      }\n      if(append){\n        setUsers([...users, ..._users.data.results]);\n        goneNext = false;\n      }\n      else{\n        setUsers(_users.data.results);\n      }\n      \n      setFetching(false);\n    }\n\n    checkLastChat(_users.data.results)\n  };\n\n  const checkLastChat = (users) => {\n    let lastUserChat = localStorage.getItem(LastUserChat)\n    if(lastUserChat){\n      lastUserChat = JSON.parse(lastUserChat);\n      if(users.filter(item => item.id === lastUserChat.id).length){\n        setActiveUser(lastUserChat)\n      }\n    }\n  }\n\n  const setActiveUser = (user_data) => {\n    localStorage.setItem(LastUserChat, JSON.stringify(user_data))\n    dispatch({ type: activeChatUserAction, payload: user_data });\n  };\n\n  const handleScroll = (e) => {\n    if(e.target.scrollTop >= (e.target.scrollHeight - (e.target.offsetHeight + 200))){\n      if(canGoNext && !goneNext){\n        getUserList(true)\n      }\n    }\n  }\n\n  return (\n    <div>\n      <SearchDebouce setSearch={setSearch} />\n      <div className=\"userList\" onScroll={handleScroll}>\n        {fetching ? (\n          <center>\n            <Loader />\n          </center>\n        ) : users.length < 1 ? (\n          <div className=\"noUser\">You don't have any user to chat with.</div>\n        ) : (\n          users.map((item, i) => (\n            <UserMain\n              key={i}\n              name={`${item.first_name || \"\"} ${item.last_name || \"\"}`}\n              profilePicture={item.profile_picture ? item.profile_picture.file_upload : \"\"}\n              caption={item.caption}\n              count={item.message_count}\n              clickable\n              onClick={() => setActiveUser(item)}\n            />\n          ))\n        )}\n      </div>\n    </div>\n  );\n}\n\nlet debouceTimeout;\n\nconst SearchDebouce = (props) => {\n  const [search, setSearch] = useState(\"\")\n\n  useEffect(() => {\n    clearTimeout(debouceTimeout);\n    debouceTimeout = setTimeout(() => {\n      props.setSearch(search)\n    }, 1000)\n  }, [search])\n\n  return (\n    <div className=\"searchCon\">\n        <img src={searchImg} />\n        <input placeholder=\"Search users\" value={search} onChange={e => setSearch(e.target.value)} />\n      </div>\n  )\n}\n\nexport default UsersList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}