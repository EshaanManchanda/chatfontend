{"ast":null,"code":"var _jsxFileName = \"F:\\\\coding\\\\python\\\\Django_Project\\\\chat_service\\\\chatfrontend\\\\src\\\\Pages\\\\authController.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useContext } from \"react\";\nimport Loader from \"../components/loader\";\nimport { axiosHandler, getToken, LastUserChat } from \"../helper\";\nimport { REFERESH_URL, ME_URL, LOGOUT_URL } from \"../urls\";\nimport { store } from \"../stateManagement/store\";\nimport { userDetailAction } from \"../stateManagement/actions\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const tokenName = \"tokenName\";\nexport const logout = props => {\n  if (localStorage.getItem(tokenName)) {\n    axiosHandler({\n      method: \"get\",\n      url: LOGOUT_URL,\n      token: getToken()\n    });\n  }\n\n  localStorage.removeItem(tokenName);\n  localStorage.removeItem(LastUserChat);\n  window.location.href = \"/login\";\n};\nexport const checkAuthState = async (setChecking, dispatch, props) => {\n  let token = localStorage.getItem(tokenName);\n\n  if (!token) {\n    logout(props);\n    return;\n  }\n\n  token = JSON.parse(token);\n  const userProfile = await axiosHandler({\n    method: \"get\",\n    url: ME_URL,\n    token: token.access\n  }).catch(e => null);\n\n  if (userProfile) {\n    setChecking(false);\n    dispatch({\n      type: userDetailAction,\n      payload: userProfile.data\n    });\n  } else {\n    const getNewAccess = await axiosHandler({\n      method: \"post\",\n      url: REFERESH_URL,\n      data: {\n        refresh: token.refresh\n      }\n    }).catch(e => null);\n\n    if (getNewAccess) {\n      localStorage.setItem(tokenName, JSON.stringify(getNewAccess.data));\n      checkAuthState(setChecking, dispatch, props);\n    } else {\n      logout(props);\n    }\n  }\n};\n\nconst AuthController = props => {\n  _s();\n\n  const [checking, setChecking] = useState(true);\n  const {\n    dispatch\n  } = useContext(store);\n  useEffect(() => {\n    checkAuthState(setChecking, dispatch, props);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"authContainer\",\n    children: checking ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"centerAll\",\n      children: /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }, this) : props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AuthController, \"PpcR/sUDYgzFyHMbXIxdqZOnpUY=\");\n\n_c = AuthController;\nexport default AuthController;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthController\");","map":{"version":3,"names":["React","useEffect","useState","useContext","Loader","axiosHandler","getToken","LastUserChat","REFERESH_URL","ME_URL","LOGOUT_URL","store","userDetailAction","tokenName","logout","props","localStorage","getItem","method","url","token","removeItem","window","location","href","checkAuthState","setChecking","dispatch","JSON","parse","userProfile","access","catch","e","type","payload","data","getNewAccess","refresh","setItem","stringify","AuthController","checking","children"],"sources":["F:/coding/python/Django_Project/chat_service/chatfrontend/src/Pages/authController.js"],"sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\nimport Loader from \"../components/loader\";\nimport { axiosHandler, getToken, LastUserChat } from \"../helper\";\nimport { REFERESH_URL, ME_URL, LOGOUT_URL } from \"../urls\";\nimport { store } from \"../stateManagement/store\";\nimport { userDetailAction } from \"../stateManagement/actions\";\n\nexport const tokenName = \"tokenName\";\n\nexport const logout = (props) => {\n  if (localStorage.getItem(tokenName)) {\n    axiosHandler({\n      method: \"get\",\n      url: LOGOUT_URL,\n      token: getToken(),\n    });\n  }\n  localStorage.removeItem(tokenName);\n  localStorage.removeItem(LastUserChat);\n  window.location.href = \"/login\";\n};\n\nexport const checkAuthState = async (setChecking, dispatch, props) => {\n  let token = localStorage.getItem(tokenName);\n  if (!token) {\n    logout(props);\n    return;\n  }\n  token = JSON.parse(token);\n  const userProfile = await axiosHandler({\n    method: \"get\",\n    url: ME_URL,\n    token: token.access,\n  }).catch((e) => null);\n  if (userProfile) {\n    setChecking(false);\n    dispatch({ type: userDetailAction, payload: userProfile.data });\n  } else {\n    const getNewAccess = await axiosHandler({\n      method: \"post\",\n      url: REFERESH_URL,\n      data: {\n        refresh: token.refresh,\n      },\n    }).catch((e) => null);\n    if (getNewAccess) {\n      localStorage.setItem(tokenName, JSON.stringify(getNewAccess.data));\n      checkAuthState(setChecking, dispatch, props);\n    } else {\n      logout(props);\n    }\n  }\n};\n\nconst AuthController = (props) => {\n  const [checking, setChecking] = useState(true);\n\n  const { dispatch } = useContext(store);\n\n  useEffect(() => {\n    checkAuthState(setChecking, dispatch, props);\n  }, []);\n\n  return (\n    <div className=\"authContainer\">\n      {checking ? (\n        <div className=\"centerAll\">\n          <Loader />\n        </div>\n      ) : (\n        props.children\n      )}\n    </div>\n  );\n};\n\nexport default AuthController;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}